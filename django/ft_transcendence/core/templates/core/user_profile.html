{% load static %}
{% load socialaccount %}
{% include 'core/sidenav.html' %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'core/css/user_profile.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/social.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/login.css' %}">
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <title>Profile Page</title>
</head>

<body class="no-scroll">
    <!---------- Global container for layout management ---------->
    <div class="container">
        <!---------- Background Video ---------->
        <video autoplay muted loop class="video-background">
            <source src="{% static 'core/images/planet-background.mp4' %}" type="video/mp4">
            Your browser does not support the video tag.
        </video>

        <div class="profile--info-container">
            <!---------- Stats ---------->
            <div class="profile--stats-global-container">
                <div class="profile--stats-content">
                    <div class="profile--stats-title-container">
                        <h2 class="profile--stats-title">Game Stats</h2>
                    </div>
                    <div class ="profile--stats">
                        <img src="{% static 'core/images/win-logo3.png' %}" class="stats-logos">
                        <p> {{ user_profile.userprofile.victory }}</p>
                    </div>
                    <div class ="profile--stats">
                        <img src="{% static 'core/images/defeats-logo.png' %}" class="stats-logos">
                        <p> {{ user_profile.userprofile.defeat }}</p>
                    </div>
                </div>
            </div>

            <div class="profile--main-info-container">
                <!---------- Avatar ---------->
                <div class="profile--avatar-username-container">
                    <div class="container--user-avatar">
                        <img src="{{ user_profile.userprofile.avatar.url }}" alt="User Avatar" class="profile--user-avatar user-avatar-img"/>
                    </div>
                    <!---------- Username ---------->
                    <div class="profile--username ">
                        <h2>{{ user_profile.username }}</h2>
                    </div>
                </div>

                <div class="profile--buttons-container">
                    {% if request.user.id != user_profile.id %}
                        <!---------- Random user ---------->
                        <div class="profile--friend-request-button-container">
                            {% if not is_friend and not sent_friend_request and not received_friend_request %}
                            <form action="/send_friend_request/{{ user_profile.id }}/" method="post">
                                {% csrf_token %}
                                <button type="submit" class="profile--buttons buttons-design">
                                    <span>Send a Friend Request</span>
                                </button>
                            </form>
                            {% elif sent_friend_request %}
                            <button type="submit" class="social--user-profile-buttons-design buttons-design">
                                <a href="{% url 'core:decline_friend_request' sent_friend_request.id %}">
                                    Delete this friend request<img src="{% static 'core/images/decline-logo.png'%}" class="social--buttons-section-logos">
                                </a>
                            </button>
                            {% elif received_friend_request %}
                            <button type="submit" class="social--user-profile-buttons-design buttons-design">
                                <a href="{% url 'core:decline_friend_request' received_friend_request.id %}">
                                    Decline Friend Request <img src="{% static 'core/images/decline-logo.png'%}" class="social--buttons-section-logos">
                                </a>
                            </button>
                            {% endif %}
                        </div>

                        <!---------- Friend ---------->
                        {% if is_friend %}
                        <div class="profile--message-button-container">
                            <form action="{% url 'chat:room' room_name user_profile.id %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="profile--buttons buttons-design">
                                    <img src="{% static 'core/images/chat-logo.png' %}" class="icons-logos">
                                    <span> Message </span>
                                </button>
                            </form>
                            <button type="submit" class="profile--buttons buttons-design">
                                <a href="{% url 'core:remove_friend' user_profile.id %}">
                                    Remove this friend <img src="{% static 'core/images/decline-logo.png'%}" class="social--buttons-section-logos">
                                </a>
                            </button>
                        </div>
                        {% else %}
                        <div class="add-friend">
                            <p>Add this friend to send a direct message</p>
                        </div>
                        {% endif %}
                    {% endif %}

                    <!---------- Block Button ---------->
                    <div class="profile--block-button-container">
                        {% if user_profile != user %}
                        <button type="submit" class="profile--buttons buttons-design" onclick="window.location.href='/block_user/{{ user_profile.id }}'">
                            <img src="{% static 'core/images/blocked-logo-white.png' %}" class="icons-logos">
                            <span>Block</span>
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
